{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { Fragment, useEffect, useState } from \"react\"; //redux\n\nimport { connect, useSelector, useDispatch } from \"react-redux\";\nimport { add_org_id, add_des_id } from \"../redux/basicdatas/action\";\nimport { loadCity } from \"../redux/cityList/action\"; //UI Libraries\n\nimport { FaExchangeAlt, FaRegCalendarAlt } from \"react-icons/fa\";\nimport { IoIosAirplane } from \"react-icons/io\";\nimport { MdKeyboardArrowDown } from \"react-icons/md\";\nimport { MdLens } from \"react-icons/md\";\nimport { InputGroup, InputGroupAddon, InputGroupText, Button, Container, Row, Col } from \"reactstrap\";\nimport { makeStyles, InputLabel, MenuItem, FormControl, Select, Chip, TextField } from \"@material-ui/core\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport DatePicker from \"react-modern-calendar-datepicker\"; //components\n\nimport RoundButton from \"./roundbutton\";\nimport Rooms from './rooms'; //utilities\n\nimport { DotLoading } from \"../Functions\"; //css\n\nimport 'react-modern-calendar-datepicker/lib/DatePicker.css';\n;\nconst useStyles = makeStyles(theme => ({\n  button: {\n    display: \"block\",\n    marginTop: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  }\n}));\n\nconst SearchBoxTour = props => {\n  const classes = useStyles();\n  const {\n    0: showChild,\n    1: setShowChild\n  } = useState(false);\n  const {\n    0: tourCategory,\n    1: setTourCategory\n  } = useState(\"\");\n  const {\n    0: valueOrigin,\n    1: setValueOrigin\n  } = useState([\"\"]);\n  const {\n    0: cityIdOrg,\n    1: setCityIdOrg\n  } = useState(0);\n  const {\n    0: cityIdDes,\n    1: setCityIdDes\n  } = useState(0);\n  const {\n    0: valueDestination,\n    1: setValueDestination\n  } = useState(\"\");\n  const {\n    0: originString,\n    1: setOriginString\n  } = useState(\"\");\n  const {\n    0: destinationString,\n    1: setDestinationString\n  } = useState(\"\");\n  const {\n    0: open,\n    1: setOpen\n  } = useState(false);\n  const {\n    0: selectedDayOrg,\n    1: setSelectedDayOrg\n  } = useState(null);\n  const {\n    0: selectedDayDes,\n    1: setSelectedDayDes\n  } = useState(null);\n  const cityList = useSelector(state => state.cityListReducer.cityList);\n  const dispatch = useDispatch();\n  const rooms = useSelector(state => state.roomsReducer.rooms);\n  const inc1 = useSelector(state => state.roomsReducer.adultArray);\n  const inc2 = useSelector(state => state.roomsReducer.childArray);\n  const selValues = useSelector(state => state.roomsReducer.selValues);\n  const total = useSelector(state => state.roomsReducer.total);\n  const infantCount = useSelector(state => state.roomsReducer.infantCount);\n  const child1Count = useSelector(state => state.roomsReducer.child1Count);\n  const child2Count = useSelector(state => state.roomsReducer.child2Count); //tour type select box\n\n  const handleChange = event => {\n    setTourCategory(event.target.value);\n  }; //tour type select box\n\n\n  const handleClose = () => {\n    setOpen(false);\n  }; //tour type select box\n\n\n  const handleOpen = () => {\n    setOpen(true);\n  };\n\n  useEffect(() => {\n    //reed cityList from api\n    dispatch(loadCity());\n    setShowChild(true);\n  }, []);\n\n  function getOptionSelectedOrigin(event, newValue) {\n    setValueOrigin(newValue);\n    let str = \"\";\n    let ctId = []; //origin data structure \"TEH-ISF\"\n\n    for (var i = 0; i < newValue.length; i++) {\n      if (i === newValue.length - 1) str += newValue[i].CityAbbrevation;else str += newValue[i].CityAbbrevation + \"-\";\n      ctId.push(newValue[i].CityId);\n    }\n\n    setOriginString(str);\n    setCityIdOrg(ctId); //city orgId set in redux\n\n    props.dispatch(add_org_id(ctId));\n  }\n\n  function getOptionSelectedDestination(event, value) {\n    setValueDestination(value);\n    let str = \"\";\n    let ctId = []; //destination data structure \"TEH-ISF\"\n\n    for (var i = 0; i < value.length; i++) {\n      if (i === value.length - 1) str += value[i].CityAbbrevation;else str += value[i].CityAbbrevation + \"-\";\n      ctId.push(value[i].CityId);\n    }\n\n    setDestinationString(str);\n    setCityIdDes(ctId); //city desId set in redux\n\n    props.dispatch(add_des_id(ctId));\n  } //change destination and origin\n\n\n  function handleChangeOrgDes() {\n    let tempOrg = valueOrigin;\n    let tempDes = valueDestination;\n    let tempOrgStr = originString;\n    let tempDesStr = destinationString;\n    let tempOrgID = cityIdOrg;\n    let tempDesId = cityIdDes;\n    setCityIdOrg(tempDesId); //city orgId set in redux\n\n    props.dispatch(add_org_id(tempDesId));\n    setCityIdDes(tempOrgID); //city desId set in redux\n\n    props.dispatch(add_des_id(tempOrgID));\n    setOriginString(tempDesStr);\n    setDestinationString(tempOrgStr);\n    setValueOrigin(tempDes);\n    setValueDestination(tempOrg);\n  } //make day and month 2 figit :07/05\n\n\n  var dateOrigin = 0;\n  var dateDestination = 0;\n  var zero = \"0\";\n\n  if (selectedDayOrg !== null) {\n    let orgD = selectedDayOrg.day.toString().length === 1 ? zero.toString().concat(selectedDayOrg.day.toString()).toString() : selectedDayOrg.day;\n    let orgM = selectedDayOrg.month.toString().length === 1 ? `0${selectedDayOrg.month}` : selectedDayOrg.month;\n    dateOrigin = selectedDayOrg.year + \"-\" + orgM + \"-\" + orgD;\n  }\n\n  if (selectedDayDes !== null) {\n    let desD = selectedDayDes.day.toString().length === 1 ? `0${selectedDayDes.day}` : selectedDayDes.day;\n    let desM = selectedDayDes.month.toString().length === 1 ? `0${selectedDayDes.month}` : selectedDayDes.month;\n    dateDestination = selectedDayDes.year + \"-\" + desM + \"-\" + desD;\n  }\n\n  const adultCount = inc1.reduce(function myFunc(a, b) {\n    return a + b;\n  });\n  var roomRules = \"\";\n\n  for (var i = 0; i < selValues.length; i++) {\n    let adult = selValues[i].adult;\n    let infant = 0;\n    let child1 = 0;\n    let child2 = 0;\n\n    for (var j = 0; j < selValues[i].age.length; j++) {\n      if (selValues[i].age[j] === 0 || selValues[i].age[j] === 1) {\n        infant = infant + 1;\n      }\n\n      if (selValues[i].age[j] === 2 || selValues[i].age[j] === 3 || selValues[i].age[j] === 4 || selValues[i].age[j] === 5) {\n        child1 = child1 + 1;\n      }\n\n      if (selValues[i].age[j] === 6 || selValues[i].age[j] === 7 || selValues[i].age[j] === 8 || selValues[i].age[j] === 9 || selValues[i].age[j] === 10 || selValues[i].age[j] === 11) {\n        child2 = child2 + 1;\n      }\n    }\n\n    const einRoom = adult.toString().concat(child1.toString(), child2.toString(), infant.toString());\n    if (roomRules === \"\") roomRules = roomRules.concat(einRoom);else roomRules = roomRules.concat(\",\", einRoom);\n  }\n\n  const searchParams = {\n    org: originString,\n    des: destinationString,\n    adult: adultCount,\n    infant: infantCount,\n    child1: child1Count,\n    child2: child2Count,\n    selValues: JSON.stringify(selValues),\n    roomCount: rooms,\n    roomRules: roomRules.toString(),\n    orgDate: dateOrigin.toString(),\n    desDate: dateDestination.toString(),\n    tourCategory: tourCategory\n  };\n  if (!showChild) return __jsx(DotLoading, null);\n  return __jsx(Fragment, null, __jsx(\"div\", {\n    className: \"inputgroups\"\n  }, __jsx(Container, null, __jsx(Row, null, __jsx(Col, {\n    md: \"6\",\n    className: \"airport-col no-padding\"\n  }, __jsx(InputGroup, null, __jsx(Autocomplete, {\n    id: \"fixed-tags-demo\",\n    className: \"airport-auto form-control\",\n    multiple: true,\n    options: cityList,\n    filterSelectedOptions: true,\n    onChange: (event, newValue) => getOptionSelectedOrigin(event, newValue),\n    groupBy: option => option.CountryAbbrevation === \"IR\" ? \"شهرهای پرتردد\" : \"سایر شهرها\",\n    getOptionLabel: option => __jsx(\"div\", null, __jsx(MdLens, {\n      className: \"pl-1\",\n      size: \"10\",\n      color: \"#65bfbe\"\n    }), __jsx(\"span\", {\n      className: \"optionRight\"\n    }, option.CityTitle_Persian), __jsx(\"span\", {\n      className: \"optionLeft-autocomplete\"\n    }, option.CityAbbrevation)),\n    renderTags: (newValue, getTagProps) => newValue.map((option, index) => __jsx(Chip, _extends({\n      label: option.CityTitle_Persian\n    }, getTagProps({\n      index\n    }), {\n      key: index\n    }))),\n    style: {\n      width: \"100%\",\n      fontFamily: \"IRANSansWeb\"\n    },\n    style: {\n      width: 300\n    },\n    renderInput: params => __jsx(TextField, _extends({}, params, {\n      variant: \"outlined\",\n      fullWidth: true\n    }))\n  }), __jsx(InputGroupAddon, {\n    addonType: \"append\",\n    className: \"airport-append\"\n  }, __jsx(InputGroupText, null, __jsx(\"div\", {\n    className: \"source-plane\"\n  }, __jsx(IoIosAirplane, null)), \"\\u0645\\u0628\\u062F\\u0627\\u064C\\u061F\"))), __jsx(Button, {\n    onClick: handleChangeOrgDes,\n    className: \"input-btn\"\n  }, __jsx(FaExchangeAlt, null)), __jsx(InputGroup, {\n    className: \"airport-dest\"\n  }, __jsx(Autocomplete, {\n    className: \"airport-auto form-control\",\n    multiple: true,\n    filterSelectedOptions: true,\n    id: \"fixed-tags-2\",\n    options: cityList,\n    onChange: (e, value) => getOptionSelectedDestination(e, value),\n    groupBy: toption => toption.CountryAbbrevation === \"IR\" ? \"شهرهای پرتردد\" : \"سایر شهرها\",\n    getOptionLabel: option => __jsx(\"div\", null, __jsx(MdLens, {\n      className: \"pl-1\",\n      size: \"10\",\n      color: \"#65bfbe\"\n    }), __jsx(\"span\", {\n      className: \"optionRight\"\n    }, option.CityTitle_Persian), __jsx(\"span\", {\n      className: \"optionLeft-autocomplete \"\n    }, option.CityAbbrevation)) //defaultValue={[ top100Films[13]]}\n    // getOptionSelected={getSelectedAus(value)}\n    ,\n    renderTags: (value, getTagProps) => value.map((option, index) => __jsx(Chip, _extends({\n      label: option.CityTitle_Persian\n    }, getTagProps({\n      index\n    }), {\n      key: index\n    }))),\n    style: {\n      width: \"100%\",\n      fontFamily: \"IRANSansWeb\"\n    },\n    renderInput: params => __jsx(TextField, _extends({}, params, {\n      variant: \"outlined\",\n      fullWidth: true\n    }))\n  }), __jsx(InputGroupAddon, {\n    addonType: \"append\",\n    className: \"airport-append\"\n  }, __jsx(InputGroupText, null, __jsx(\"div\", {\n    className: \"dest-plane\"\n  }, __jsx(IoIosAirplane, null)), \"\\u0645\\u0642\\u0635\\u062F\\u061F\")))), __jsx(Col, {\n    md: \"6\",\n    className: \"date-col no-padding\"\n  }, __jsx(InputGroup, null, __jsx(InputGroupAddon, {\n    addonType: \"append\"\n  }, __jsx(InputGroupText, null, __jsx(\"div\", {\n    className: \"calendar-icon\"\n  }, __jsx(FaRegCalendarAlt, null)), \"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u0631\\u0641\\u062A\", __jsx(DatePicker, {\n    value: selectedDayOrg,\n    onChange: setSelectedDayOrg,\n    inputPlaceholder: \" \",\n    shouldHighlightWeekends: true,\n    locale: \"fa\"\n  })))), __jsx(InputGroup, null, __jsx(InputGroupAddon, {\n    addonType: \"append\"\n  }, __jsx(InputGroupText, null, __jsx(\"div\", {\n    className: \"calendar-icon\"\n  }, __jsx(FaRegCalendarAlt, null)), \"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u0628\\u0631\\u06AF\\u0634\\u062A\", __jsx(DatePicker, {\n    value: selectedDayDes,\n    onChange: setSelectedDayDes,\n    inputPlaceholder: \" \",\n    shouldHighlightWeekends: true,\n    locale: \"fa\"\n  })))))))), __jsx(\"div\", {\n    className: \"search-dropdown\"\n  }, __jsx(Container, null, __jsx(Row, null, __jsx(Col, {\n    md: \"6\",\n    xs: \"6\"\n  }, __jsx(\"div\", {\n    className: \"tour-type right-to-left\"\n  }, __jsx(FormControl, {\n    className: classes.formControl\n  }, __jsx(InputLabel, {\n    id: \"demo-controlled-open-select-label\"\n  }, \"\\u0633\\u0628\\u06A9 \\u062A\\u0648\\u0631\"), __jsx(Select, {\n    labelId: \"demo-controlled-open-select-label\",\n    id: \"demo-controlled-open-select\",\n    open: open,\n    onClose: handleClose,\n    onOpen: handleOpen,\n    value: tourCategory,\n    onChange: handleChange\n  }, __jsx(MenuItem, {\n    value: \"\"\n  }, __jsx(\"em\", null, \"\\u0647\\u0645\\u0647 \\u0645\\u0648\\u0627\\u0631\\u062F\")), __jsx(MenuItem, {\n    value: 10\n  }, \"\\u062A\\u0641\\u0631\\u06CC\\u062D\\u06CC\"), __jsx(MenuItem, {\n    value: 20\n  }, \"\\u0637\\u0628\\u06CC\\u0639\\u062A \\u06AF\\u0631\\u062F\\u06CC\"), __jsx(MenuItem, {\n    value: 30\n  }, \"\\u0632\\u06CC\\u0627\\u0631\\u062A\\u06CC\")), __jsx(MdKeyboardArrowDown, null)))), __jsx(Col, {\n    md: \"6\",\n    xs: \"6\"\n  }, __jsx(Rooms, null))))), __jsx(RoundButton, {\n    searchParams: searchParams,\n    name: \"\\u062C\\u0633\\u062A\\u062C\\u0648\"\n  }));\n};\n\nexport default connect()(SearchBoxTour);","map":null,"metadata":{},"sourceType":"module"}