{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(searchTourSaga),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(loadCityWatcher);\n\nimport { put, takeLatest } from \"redux-saga/effects\";\nimport es6promise from \"es6-promise\";\nimport \"isomorphic-unfetch\"; //imports\n\nimport { searchTourSuccess, failure } from \"./action\";\nimport { actionTypes } from \"./type\";\nimport ports from \"../../ports\";\nes6promise.polyfill();\n\nfunction searchTourSaga(action) {\n  var body, counter, CorrectTour, res, data, i;\n  return _regeneratorRuntime.wrap(function searchTourSaga$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          body = _JSON$stringify(action.data);\n          counter = 0;\n          CorrectTour = [];\n          _context.prev = 3;\n          _context.next = 6;\n          return fetch(\"\".concat(ports.domain).concat(ports.getPackages, \"?filter=\").concat(body));\n\n        case 6:\n          res = _context.sent;\n          _context.next = 9;\n          return res.json();\n\n        case 9:\n          data = _context.sent;\n          console.log(\" search Results\", data);\n\n          for (i = 0; i < data.length; i++) {\n            if (data[i].hasOwnProperty(\"PackageRow\") && data[i].PackageRow.length > 0 && data[i].hasOwnProperty(\"Flight\") && data[i].Flight.length > 0) {\n              counter++;\n              CorrectTour.push(data[i]);\n            }\n          }\n\n          console.log(\"correct packages\", counter);\n\n          if (!(counter > 0)) {\n            _context.next = 18;\n            break;\n          }\n\n          _context.next = 16;\n          return put(searchTourSuccess(CorrectTour));\n\n        case 16:\n          _context.next = 20;\n          break;\n\n        case 18:\n          _context.next = 20;\n          return put(failure(\"No Correct Package Found\"));\n\n        case 20:\n          _context.next = 26;\n          break;\n\n        case 22:\n          _context.prev = 22;\n          _context.t0 = _context[\"catch\"](3);\n          _context.next = 26;\n          return put(failure(_context.t0));\n\n        case 26:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[3, 22]]);\n}\n\nfunction loadCityWatcher() {\n  return _regeneratorRuntime.wrap(function loadCityWatcher$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return takeLatest(actionTypes.LOAD_SEARCH_TOUR, searchTourSaga);\n\n        case 2:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2);\n}\n\nexport default loadCityWatcher;","map":{"version":3,"sources":["C:/Users/Hope/Desktop/KiteSearchEngine/redux/searchtour/saga.js"],"names":["searchTourSaga","loadCityWatcher","put","takeLatest","es6promise","searchTourSuccess","failure","actionTypes","ports","polyfill","action","body","data","counter","CorrectTour","fetch","domain","getPackages","res","json","console","log","i","length","hasOwnProperty","PackageRow","Flight","push","LOAD_SEARCH_TOUR"],"mappings":";;;;;yBAWUA,c;;;yBAgCAC,e;;AA3CV,SAASC,GAAT,EAAcC,UAAd,QAAgC,oBAAhC;AACA,OAAOC,UAAP,MAAuB,aAAvB;AACA,OAAO,oBAAP,C,CAEA;;AACA,SAASC,iBAAT,EAA4BC,OAA5B,QAA2C,UAA3C;AACA,SAASC,WAAT,QAA4B,QAA5B;AACA,OAAOC,KAAP,MAAkB,aAAlB;AAEAJ,UAAU,CAACK,QAAX;;AAEA,SAAUT,cAAV,CAAyBU,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AACQC,UAAAA,IADR,GACe,gBAAeD,MAAM,CAACE,IAAtB,CADf;AAEMC,UAAAA,OAFN,GAEgB,CAFhB;AAGMC,UAAAA,WAHN,GAGoB,EAHpB;AAAA;AAAA;AAKgB,iBAAMC,KAAK,WAClBP,KAAK,CAACQ,MADY,SACHR,KAAK,CAACS,WADH,qBACyBN,IADzB,EAAX;;AALhB;AAKUO,UAAAA,GALV;AAAA;AAQiB,iBAAMA,GAAG,CAACC,IAAJ,EAAN;;AARjB;AAQUP,UAAAA,IARV;AASIQ,UAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BT,IAA/B;;AACA,eAASU,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAGV,IAAI,CAACW,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AACpC,gBACEV,IAAI,CAACU,CAAD,CAAJ,CAAQE,cAAR,CAAuB,YAAvB,KACAZ,IAAI,CAACU,CAAD,CAAJ,CAAQG,UAAR,CAAmBF,MAAnB,GAA4B,CAD5B,IAEAX,IAAI,CAACU,CAAD,CAAJ,CAAQE,cAAR,CAAuB,QAAvB,CAFA,IAGAZ,IAAI,CAACU,CAAD,CAAJ,CAAQI,MAAR,CAAeH,MAAf,GAAwB,CAJ1B,EAKE;AACAV,cAAAA,OAAO;AACPC,cAAAA,WAAW,CAACa,IAAZ,CAAiBf,IAAI,CAACU,CAAD,CAArB;AACD;AACF;;AACDF,UAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCR,OAAhC;;AArBJ,gBAsBQA,OAAO,GAAE,CAtBjB;AAAA;AAAA;AAAA;;AAAA;AAuBM,iBAAMX,GAAG,CAACG,iBAAiB,CAACS,WAAD,CAAlB,CAAT;;AAvBN;AAAA;AAAA;;AAAA;AAAA;AAyBM,iBAAMZ,GAAG,CAACI,OAAO,CAAC,0BAAD,CAAR,CAAT;;AAzBN;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA4BI,iBAAMJ,GAAG,CAACI,OAAO,aAAR,CAAT;;AA5BJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAgCA,SAAUL,eAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,iBAAME,UAAU,CAACI,WAAW,CAACqB,gBAAb,EAA+B5B,cAA/B,CAAhB;;AADF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIA,eAAeC,eAAf","sourcesContent":["import { put, takeLatest } from \"redux-saga/effects\";\r\nimport es6promise from \"es6-promise\";\r\nimport \"isomorphic-unfetch\";\r\n\r\n//imports\r\nimport { searchTourSuccess, failure } from \"./action\";\r\nimport { actionTypes } from \"./type\";\r\nimport ports from \"../../ports\";\r\n\r\nes6promise.polyfill();\r\n\r\nfunction* searchTourSaga(action) {\r\n  const body = JSON.stringify(action.data);\r\n  let counter = 0;\r\n  let CorrectTour = [];\r\n  try {\r\n    const res = yield fetch(\r\n      `${ports.domain}${ports.getPackages}?filter=${body}`\r\n    );\r\n    const data = yield res.json();\r\n    console.log(\" search Results\", data);\r\n    for (var i = 0; i < data.length; i++) {\r\n      if (\r\n        data[i].hasOwnProperty(\"PackageRow\") &&\r\n        data[i].PackageRow.length > 0 &&\r\n        data[i].hasOwnProperty(\"Flight\") &&\r\n        data[i].Flight.length > 0\r\n      ) {\r\n        counter++;\r\n        CorrectTour.push(data[i]);\r\n      }\r\n    }\r\n    console.log(\"correct packages\", counter);\r\n    if (counter> 0) {\r\n      yield put(searchTourSuccess(CorrectTour));\r\n    } else {\r\n      yield put(failure(\"No Correct Package Found\"));\r\n    }\r\n  } catch (err) {\r\n    yield put(failure(err));\r\n  }\r\n}\r\n\r\nfunction* loadCityWatcher() {\r\n  yield takeLatest(actionTypes.LOAD_SEARCH_TOUR, searchTourSaga);\r\n}\r\n\r\nexport default loadCityWatcher;\r\n"]},"metadata":{},"sourceType":"module"}